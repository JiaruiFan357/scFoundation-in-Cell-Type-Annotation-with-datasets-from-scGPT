# scFoundation-in-Cell-Type-Annotation-with-datasets-from-scGPT

This repository provides a pipeline for cell type annotation in single-cell RNA sequencing using datasets from scGPT. The tools herein convert scGPT-formatted data into the appropriate format for scFoundation, perform model fine-tuning on a pre-trained scFoundation model, and generate predictions with associated result figures.

## Overview

The pipeline consists of the following key components:

- **Split.py**:  
  Converts input data from scGPT into the format required by scFoundation.

- **ft_ml.py**:  
  Fine-tunes the pre-trained scFoundation model using the data generated by `Split.py`.

- **prediction.py**:  
  Utilizes the fine-tuned model (with the best saved weights in a `.pth` file) to generate predictions and produce result figures.

- **scFoundation_environment.yml**:  
  Provides the Conda environment configuration needed to run the code.

## Data

The pipeline is demonstrated using the hPancreas dataset. You can download the dataset from the following [link](https://drive.google.com/drive/folders/1s9XjcSiPC-FYV3VeHrEa7SeZetrthQVV)


## References

The code in this repository builds upon and adapts ideas from the following projects:

- [scFoundation Model](https://github.com/bmmoore43/scFoundation_model/tree/main)
- [scGPT](https://github.com/bowang-lab/scGPT/tree/main)
- [Systematic Evaluation of Single-Cell Foundation Models](https://github.com/Neillzt/Systematic-Evaluation-of-Single-Cell-Foundation-Models?tab=readme-ov-file)

