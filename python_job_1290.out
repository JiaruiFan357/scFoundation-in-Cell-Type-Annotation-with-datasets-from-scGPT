==========================================
SLURM_JOB_ID = 1290
SLURM_NODELIST = pascal-node01.l3s.intra
==========================================

Processing seed 0
n_claaes =  14
{'mask_gene_name': False, 'gene_num': 19266, 'seq_len': 19266, 'encoder': {'hidden_dim': 768, 'depth': 12, 'heads': 12, 'dim_head': 64, 'seq_len': 19266, 'module_type': 'transformer', 'norm_first': False}, 'decoder': {'hidden_dim': 512, 'depth': 6, 'heads': 8, 'dim_head': 64, 'module_type': 'performer', 'seq_len': 19266, 'norm_first': False}, 'n_class': 104, 'pad_token_id': 103, 'mask_token_id': 102, 'bin_num': 100, 'bin_alpha': 1.0, 'rawcount': True, 'model': 'mae_autobin', 'test_valid_train_idx_dict': '/nfs_beijing/minsheng/data/os10000w-new/global_shuffle/meta.csv.train_set_idx_dict.pt', 'valid_data_path': '/nfs_beijing/minsheng/data/valid_count_10w.npz', 'num_tokens': 13, 'train_data_path': None, 'isPanA': False, 'isPlanA1': False, 'max_files_to_load': 5, 'bin_type': 'auto_bin', 'value_mask_prob': 0.3, 'zero_mask_prob': 0.03, 'replace_prob': 0.8, 'random_token_prob': 0.1, 'mask_ignore_token_ids': [0], 'decoder_add_zero': True, 'mae_encoder_max_seq_len': 15000, 'isPlanA': False, 'mask_prob': 0.3, 'model_type': 'mae_autobin', 'pos_embed': False, 'device': 'cuda'}
self.pos_emb and self.token_emb frozen
self.encoder.transformer_encoder self_attn.in_proj_weight have grad
self.encoder.transformer_encoder self_attn.in_proj_bias have grad
self.encoder.transformer_encoder self_attn.out_proj.weight have grad
self.encoder.transformer_encoder self_attn.out_proj.bias have grad
self.encoder.transformer_encoder linear1.weight have grad
self.encoder.transformer_encoder linear1.bias have grad
self.encoder.transformer_encoder linear2.weight have grad
self.encoder.transformer_encoder linear2.bias have grad
self.encoder.transformer_encoder norm1.weight have grad
self.encoder.transformer_encoder norm1.bias have grad
self.encoder.transformer_encoder norm2.weight have grad
self.encoder.transformer_encoder norm2.bias have grad
Epoch 1/7:
Train Loss: 0.8620, Train Accuracy: 80.89%
Val Accuracy: 95.83%, Val F1 Score: 0.8246, Val Precision: 0.8476, Val Recall: 0.8163
Test Accuracy: 95.91%, Test F1 Score: 0.6224, Test Precision: 0.6125, Test Recall: 0.6467

Epoch 2/7:
Train Loss: 0.2116, Train Accuracy: 96.83%
Val Accuracy: 97.54%, Val F1 Score: 0.8569, Val Precision: 0.8710, Val Recall: 0.8514
Test Accuracy: 98.00%, Test F1 Score: 0.6656, Test Precision: 0.7071, Test Recall: 0.6851

Epoch 3/7:
Train Loss: 0.1329, Train Accuracy: 97.33%
Val Accuracy: 95.55%, Val F1 Score: 0.9149, Val Precision: 0.9414, Val Recall: 0.9010
Test Accuracy: 93.30%, Test F1 Score: 0.6710, Test Precision: 0.7101, Test Recall: 0.6797

Epoch 4/7:
Train Loss: 0.0973, Train Accuracy: 97.75%
Val Accuracy: 95.93%, Val F1 Score: 0.8506, Val Precision: 0.8711, Val Recall: 0.8405
Test Accuracy: 95.96%, Test F1 Score: 0.6658, Test Precision: 0.6808, Test Recall: 0.6758

Epoch 5/7:
Train Loss: 0.0776, Train Accuracy: 98.01%
Val Accuracy: 96.21%, Val F1 Score: 0.8874, Val Precision: 0.8869, Val Recall: 0.9270
Test Accuracy: 96.15%, Test F1 Score: 0.6525, Test Precision: 0.6420, Test Recall: 0.6837

Epoch 6/7:
Train Loss: 0.0702, Train Accuracy: 97.99%
Val Accuracy: 97.25%, Val F1 Score: 0.9377, Val Precision: 0.9544, Val Recall: 0.9327
Test Accuracy: 95.60%, Test F1 Score: 0.6522, Test Precision: 0.6723, Test Recall: 0.6632

Epoch 7/7:
Train Loss: 0.0621, Train Accuracy: 98.19%
Val Accuracy: 97.54%, Val F1 Score: 0.9411, Val Precision: 0.9699, Val Recall: 0.9222
Test Accuracy: 93.75%, Test F1 Score: 0.6787, Test Precision: 0.7073, Test Recall: 0.6818


Results for seed 0:
Validation - Accuracy: 97.54%, F1: 0.8569, Precision: 0.8710, Recall: 0.8514
Test - Accuracy: 98.00%, F1: 0.6656, Precision: 0.7071, Recall: 0.6851

Processing seed 1
n_claaes =  14
{'mask_gene_name': False, 'gene_num': 19266, 'seq_len': 19266, 'encoder': {'hidden_dim': 768, 'depth': 12, 'heads': 12, 'dim_head': 64, 'seq_len': 19266, 'module_type': 'transformer', 'norm_first': False}, 'decoder': {'hidden_dim': 512, 'depth': 6, 'heads': 8, 'dim_head': 64, 'module_type': 'performer', 'seq_len': 19266, 'norm_first': False}, 'n_class': 104, 'pad_token_id': 103, 'mask_token_id': 102, 'bin_num': 100, 'bin_alpha': 1.0, 'rawcount': True, 'model': 'mae_autobin', 'test_valid_train_idx_dict': '/nfs_beijing/minsheng/data/os10000w-new/global_shuffle/meta.csv.train_set_idx_dict.pt', 'valid_data_path': '/nfs_beijing/minsheng/data/valid_count_10w.npz', 'num_tokens': 13, 'train_data_path': None, 'isPanA': False, 'isPlanA1': False, 'max_files_to_load': 5, 'bin_type': 'auto_bin', 'value_mask_prob': 0.3, 'zero_mask_prob': 0.03, 'replace_prob': 0.8, 'random_token_prob': 0.1, 'mask_ignore_token_ids': [0], 'decoder_add_zero': True, 'mae_encoder_max_seq_len': 15000, 'isPlanA': False, 'mask_prob': 0.3, 'model_type': 'mae_autobin', 'pos_embed': False, 'device': 'cuda'}
self.pos_emb and self.token_emb frozen
self.encoder.transformer_encoder self_attn.in_proj_weight have grad
self.encoder.transformer_encoder self_attn.in_proj_bias have grad
self.encoder.transformer_encoder self_attn.out_proj.weight have grad
self.encoder.transformer_encoder self_attn.out_proj.bias have grad
self.encoder.transformer_encoder linear1.weight have grad
self.encoder.transformer_encoder linear1.bias have grad
self.encoder.transformer_encoder linear2.weight have grad
self.encoder.transformer_encoder linear2.bias have grad
self.encoder.transformer_encoder norm1.weight have grad
self.encoder.transformer_encoder norm1.bias have grad
self.encoder.transformer_encoder norm2.weight have grad
self.encoder.transformer_encoder norm2.bias have grad
Epoch 1/7:
Train Loss: 0.8682, Train Accuracy: 85.12%
Val Accuracy: 97.25%, Val F1 Score: 0.7879, Val Precision: 0.7690, Val Recall: 0.8249
Test Accuracy: 94.53%, Test F1 Score: 0.6066, Test Precision: 0.6091, Test Recall: 0.6242

Epoch 2/7:
Train Loss: 0.2025, Train Accuracy: 96.79%
Val Accuracy: 98.20%, Val F1 Score: 0.8572, Val Precision: 0.8383, Val Recall: 0.9071
Test Accuracy: 96.58%, Test F1 Score: 0.6503, Test Precision: 0.7008, Test Recall: 0.6637

Epoch 3/7:
Train Loss: 0.1258, Train Accuracy: 97.39%
Val Accuracy: 98.39%, Val F1 Score: 0.8728, Val Precision: 0.8514, Val Recall: 0.9122
Test Accuracy: 97.17%, Test F1 Score: 0.6492, Test Precision: 0.6480, Test Recall: 0.6718

